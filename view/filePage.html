<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>pinkylam笔记</title>
		
		<link rel="stylesheet" href="../resource/plugins/mdui/css/mdui.min.css" />
		<link rel="stylesheet" href="../resource/css/index.css" />
		<link rel="stylesheet" href="../resource/css/article.css" />
		<link rel="stylesheet" href="../resource/plugins/editor/css/editormd.css" />
		<link rel="stylesheet" href="../resource/plugins/simple-calendar/simple-calendar.css">
		<link rel="stylesheet" href="../resource/plugins/dropzone/css/dropzone.css"  />  

		<style>
			.dz-preview{float: left;}
		</style>
	</head>
	<body>
		<div class="mdui-container-fluid">
	  		<form action="#" class="dropzone mdui-m-t-1" id="dropzone">
                <div class="fallback">
                	<input name="file" type="file" multiple="multiple"/>
                </div>
		        <div class="dz-message" style="font-size: 25px;">
					将文件拖至此处或点击上传.
		        </div>
          	</form>
		</div>
		
	</body>
	
	<script type="text/javascript" src="../resource/js/jquery.min.js" ></script>
	<script type="text/javascript" src="../resource/plugins/mdui/js/mdui.js" ></script>
	<script type="text/javascript" src="../resource/plugins/layer/2.4/layer.js" ></script>
	<script type="text/javascript" src="../resource/plugins/dropzone/dropzone.js"></script> 
	<script type="text/javascript" src="../resource/js/fileConfig.js" ></script>
	
	<script type="application/javascript">
		
		var m_file;
		
		$(function(){
			
			//获取父窗口用户标识ID
			userId = window.parent.document.getElementById('userId').value;
			
//			$.getJSON("config.json", function (data) {
//	    		m_file = new fileConfig(data);
//	    	});
	    	
	    	$("#dropzone").dropzone({
		        paramName: "file",
		        url:"http://127.0.0.1:8888/file/upload/"+userId,
		        maxFilesize: 5,
		        init: function () {
		            this.on("success", function (file, data) {
//		            	alert(JSON.stringify(data));
						if(data.success){
			                setTimeout(function () {
			                    window.location.reload();
			                }, 200);
						}else{
							layer.msg('上传大小不能超过5MB！', {icon: 7});
						}
		            });
		        },
		        sending:function(){
		        	$(".dz-message").hide();
		        }
    		});

		});
		
	</script>
	
</html>
